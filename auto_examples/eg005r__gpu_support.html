

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Evaluating CPU vs. GPU Performance &mdash; WhoBPyT 0.0.0 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" type="text/css" />
  <link rel="stylesheet" href="../_static/sphinx_tabs/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_override.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../_static/gallery-dataframe.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script src="../_static/debug.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Fitting JR model (Tepit data)" href="eg004r__fitting_JR_example.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> WhoBPyT
          

          
          </a>

          
            
            
              <div class="version">
                0.0.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">About WhoBPyT</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about_whobpyt/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../about_whobpyt/architecture.html">Code Architecture</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about_whobpyt/architecture.html#simplified-usage-pseudo-code">Simplified Usage Pseudo Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about_whobpyt/architecture.html#whole-brain-models">Whole Brain Models:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about_whobpyt/architecture.html#objective-function-components">Objective Function Components:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about_whobpyt/architecture.html#parameter-fitting-paradigms">Parameter Fitting Paradigms:</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about_whobpyt/architecture.html#package-expansions">Package Expansions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../about_whobpyt/background.html">Background Information</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../about_whobpyt/background.html#neuroimaging-data">Neuroimaging Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../about_whobpyt/background.html#system-model-and-biophysical-parameters">System, Model, and Biophysical Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../about_whobpyt/background.html#rwwexcinb">RWWExcInb</a></li>
<li class="toctree-l3"><a class="reference internal" href="../about_whobpyt/background.html#jansen-rit">Jansen-Rit</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Getting Started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/running_in_colab.html">Running whobpyt in google colab</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/running_in_codespaces.html">Running whobpyt in GitHub Codespaces</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../API/models.html">Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../API/optimization.html">Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../API/run.html">Run</a></li>
<li class="toctree-l1"><a class="reference internal" href="../API/visualization.html">Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../API/datatypes.html">Data Types</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="eg002r__multimodal_simulation.html">Fitting S_E Mean to 0.164 using default RWW Parameters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="eg002r__multimodal_simulation.html#importage">Importage</a></li>
<li class="toctree-l2"><a class="reference internal" href="eg002r__multimodal_simulation.html#defining-model-parameters">Defining Model Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="eg002r__multimodal_simulation.html#using-the-synthetic-cube-data-for-demo-purposes">Using the Synthetic Cube Data For Demo Purposes</a></li>
<li class="toctree-l2"><a class="reference internal" href="eg002r__multimodal_simulation.html#defining-the-cnmm-model">Defining the CNMM Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="eg002r__multimodal_simulation.html#defining-the-objective-function">Defining the Objective Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="eg002r__multimodal_simulation.html#training-the-model">Training The Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="eg002r__multimodal_simulation.html#model-simulation">Model Simulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="eg002r__multimodal_simulation.html#cnmm-validation-model">CNMM Validation Model</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="eg003r__fitting_rww_example.html">Fitting Wong_Wang model (HCP data)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="eg003r__fitting_rww_example.html#importage">Importage</a></li>
<li class="toctree-l2"><a class="reference internal" href="eg003r__fitting_rww_example.html#model-training">Model Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="eg003r__fitting_rww_example.html#model-evaluation-with-20-window-for-warmup">Model Evaluation (with 20 window for warmup)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="eg004r__fitting_JR_example.html">Fitting JR model (Tepit data)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="eg004r__fitting_JR_example.html#importage">Importage</a></li>
<li class="toctree-l2"><a class="reference internal" href="eg004r__fitting_JR_example.html#model-training">Model Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="eg004r__fitting_JR_example.html#model-evaluation-with-20-window-for-warmup">Model Evaluation (with 20 window for warmup)</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Evaluating CPU vs. GPU Performance</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#importage">Importage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#defining-the-data-and-parameters">Defining the Data and Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#training-a-cnmm-model-fixed-psd-with-batched-paradigm">Training a CNMM Model - Fixed PSD with Batched Paradigm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#training-a-cnmm-model-multimodal-objective-with-fng-fpg-paradigm">Training a CNMM Model - Multimodal Objective with FNG-FPG Paradigm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cnmm-verification-model">CNMM Verification Model</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">WhoBPyT</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Evaluating CPU vs. GPU Performance</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-eg005r-gpu-support-py"><span class="std std-ref">here</span></a>     to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="evaluating-cpu-vs-gpu-performance">
<span id="sphx-glr-auto-examples-eg005r-gpu-support-py"></span><h1>Evaluating CPU vs. GPU Performance<a class="headerlink" href="#evaluating-cpu-vs-gpu-performance" title="Permalink to this headline">¶</a></h1>
<p>GPU Support has been added to mutiple classes in WhoBPyT. This code is for evaluating the difference in speed between CPU and GPU. The relative performance will depend on the hardware being used.</p>
<p>This code is set to run on CPU by default, and then GPU can be tested by updating the device (See Importage Section).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="section" id="importage">
<h2>Importage<a class="headerlink" href="#importage" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># whobpyt stuff</span>
<span class="kn">import</span> <span class="nn">whobpyt</span>
<span class="kn">from</span> <span class="nn">whobpyt.datatypes</span> <span class="kn">import</span> <a href="../API/datatypes.html#whobpyt.datatypes.par" title="whobpyt.datatypes.par" class="sphx-glr-backref-module-whobpyt-datatypes sphx-glr-backref-type-py-class"><span class="n">par</span></a><span class="p">,</span> <span class="n">Recording</span>
<span class="kn">from</span> <span class="nn">whobpyt.models.RWWEI2</span> <span class="kn">import</span> <a href="../API/models.html#whobpyt.models.RWWEI2.RWWEI2" title="whobpyt.models.RWWEI2.RWWEI2" class="sphx-glr-backref-module-whobpyt-models-RWWEI2 sphx-glr-backref-type-py-class"><span class="n">RWWEI2_EEG_BOLD</span></a><span class="p">,</span> <span class="n">RWWEI2_EEG_BOLD_np</span><span class="p">,</span> <a href="../API/models.html#whobpyt.models.RWWEI2.RWWEI2" title="whobpyt.models.RWWEI2.RWWEI2" class="sphx-glr-backref-module-whobpyt-models-RWWEI2 sphx-glr-backref-type-py-class"><span class="n">RWWEI2</span></a><span class="p">,</span> <span class="n">RWWEI2_np</span><span class="p">,</span> <span class="n">ParamsRWWEI2</span>
<span class="kn">from</span> <span class="nn">whobpyt.models.BOLD</span> <span class="kn">import</span> <span class="n">BOLD_Layer</span><span class="p">,</span> <span class="n">BOLD_np</span><span class="p">,</span> <span class="n">BOLD_Params</span>
<span class="kn">from</span> <span class="nn">whobpyt.models.EEG</span> <span class="kn">import</span> <span class="n">EEG_Layer</span><span class="p">,</span> <span class="n">EEG_np</span><span class="p">,</span> <span class="n">EEG_Params</span>
<span class="kn">from</span> <span class="nn">whobpyt.optimization</span> <span class="kn">import</span> <span class="n">CostsFC</span><span class="p">,</span> <span class="n">CostsPSD</span><span class="p">,</span> <span class="n">CostsMean</span><span class="p">,</span> <span class="n">CostsFixedFC</span><span class="p">,</span> <a href="../API/optimization.html#whobpyt.optimization.CostsFixedPSD" title="whobpyt.optimization.CostsFixedPSD" class="sphx-glr-backref-module-whobpyt-optimization sphx-glr-backref-type-py-class"><span class="n">CostsFixedPSD</span></a>
<span class="kn">from</span> <span class="nn">whobpyt.optimization.custom_cost_mmRWW2</span> <span class="kn">import</span> <span class="n">CostsmmRWWEI2</span>
<span class="kn">from</span> <span class="nn">whobpyt.run</span> <span class="kn">import</span> <span class="n">Model_fitting</span><span class="p">,</span> <a href="../API/run.html#whobpyt.run.Fitting_FNGFPG" title="whobpyt.run.Fitting_FNGFPG" class="sphx-glr-backref-module-whobpyt-run sphx-glr-backref-type-py-class"><span class="n">Fitting_FNGFPG</span></a><span class="p">,</span> <a href="../API/run.html#whobpyt.run.Fitting_Batch" title="whobpyt.run.Fitting_Batch" class="sphx-glr-backref-module-whobpyt-run sphx-glr-backref-type-py-class"><span class="n">Fitting_Batch</span></a>
<span class="kn">from</span> <span class="nn">whobpyt.data.generators</span> <span class="kn">import</span> <span class="n">gen_cube</span>

<span class="c1"># general python stuff</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1"># viz stuff</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Is cuda avaliable?&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">())</span>

<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span> <span class="c1">#Options: &quot;cpu&quot; or &quot;cuda&quot;</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Is cuda avaliable?
False
</pre></div>
</div>
</div>
<div class="section" id="defining-the-data-and-parameters">
<h2>Defining the Data and Parameters<a class="headerlink" href="#defining-the-data-and-parameters" title="Permalink to this headline">¶</a></h2>
<p>Using the Synthetic Cube Data For Demo Purposes</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">syntheticCubeInfo</span> <span class="o">=</span> <span class="n">gen_cube</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">num_regions</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">num_channels</span> <span class="o">=</span> <span class="mi">6</span>

<span class="n">Con_Mtx</span> <span class="o">=</span> <span class="n">syntheticCubeInfo</span><span class="p">[</span><span class="s2">&quot;SC&quot;</span><span class="p">]</span>
<span class="n">dist_mtx</span> <span class="o">=</span> <span class="n">syntheticCubeInfo</span><span class="p">[</span><span class="s2">&quot;dist&quot;</span><span class="p">]</span>
<span class="n">LF_Norm</span> <span class="o">=</span> <span class="n">syntheticCubeInfo</span><span class="p">[</span><span class="s2">&quot;LF&quot;</span><span class="p">]</span>
<span class="n">sourceFC</span> <span class="o">=</span> <span class="n">syntheticCubeInfo</span><span class="p">[</span><span class="s2">&quot;Source FC&quot;</span><span class="p">]</span>
<span class="n">channelFC</span> <span class="o">=</span> <span class="n">syntheticCubeInfo</span><span class="p">[</span><span class="s2">&quot;Channel FC&quot;</span><span class="p">]</span>

<span class="nb">print</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">Con_Mtx</span><span class="p">)</span><span class="o">.</span><span class="n">eigenvalues</span><span class="p">)))</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">num_regions</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">Con_Mtx</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)),</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mf">0.25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;SC of Artificial Data&quot;</span><span class="p">)</span>

<span class="c1"># Create a RWW Params</span>
<span class="n">paramsNode</span> <span class="o">=</span> <span class="n">ParamsRWWEI2</span><span class="p">(</span><span class="n">num_regions</span><span class="p">)</span>

<a href="../API/datatypes.html#whobpyt.datatypes.par" title="whobpyt.datatypes.par" class="sphx-glr-backref-module-whobpyt-datatypes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">paramsNode</span><span class="o">.</span><span class="n">J</span></a> <span class="o">=</span> <a href="../API/datatypes.html#whobpyt.datatypes.par" title="whobpyt.datatypes.par" class="sphx-glr-backref-module-whobpyt-datatypes sphx-glr-backref-type-py-class"><span class="n">par</span></a><span class="p">((</span><span class="mf">0.15</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num_regions</span><span class="p">)),</span> <span class="n">fit_par</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">asLog</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="c1">#This is a parameter that will be updated during training</span>
<a href="../API/datatypes.html#whobpyt.datatypes.par" title="whobpyt.datatypes.par" class="sphx-glr-backref-module-whobpyt-datatypes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">paramsNode</span><span class="o">.</span><span class="n">G</span></a> <span class="o">=</span> <a href="../API/datatypes.html#whobpyt.datatypes.par" title="whobpyt.datatypes.par" class="sphx-glr-backref-module-whobpyt-datatypes sphx-glr-backref-type-py-class"><span class="n">par</span></a><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">1.0</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<a href="../API/datatypes.html#whobpyt.datatypes.par" title="whobpyt.datatypes.par" class="sphx-glr-backref-module-whobpyt-datatypes sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">paramsNode</span><span class="o">.</span><span class="n">sig</span></a> <span class="o">=</span> <a href="../API/datatypes.html#whobpyt.datatypes.par" title="whobpyt.datatypes.par" class="sphx-glr-backref-module-whobpyt-datatypes sphx-glr-backref-type-py-class"><span class="n">par</span></a><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">paramsNode</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

<span class="c1">#Create #EEG Params</span>
<span class="n">paramsEEG</span> <span class="o">=</span> <span class="n">EEG_Params</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">num_regions</span><span class="p">))</span>
<span class="n">paramsEEG</span><span class="o">.</span><span class="n">LF</span> <span class="o">=</span> <span class="n">LF_Norm</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">paramsEEG</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>

<span class="c1">#Create BOLD Params</span>
<span class="n">paramsBOLD</span> <span class="o">=</span> <span class="n">BOLD_Params</span><span class="p">()</span>
<span class="n">paramsBOLD</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
<img alt="SC of Artificial Data" class="sphx-glr-single-img" src="../_images/sphx_glr_eg005r__gpu_support_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>tensor(1.)
/home/runner/work/whobpyt/whobpyt/whobpyt/datatypes/parameter.py:68: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  self.val = torch.tensor(val, dtype=torch.float32).to(device)
</pre></div>
</div>
</div>
<div class="section" id="training-a-cnmm-model-fixed-psd-with-batched-paradigm">
<h2>Training a CNMM Model - Fixed PSD with Batched Paradigm<a class="headerlink" href="#training-a-cnmm-model-fixed-psd-with-batched-paradigm" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulation Length</span>
<span class="n">step_size</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># Step Size in msecs</span>
<span class="n">sim_len</span> <span class="o">=</span> <span class="mi">1500</span> <span class="c1"># Simulation length in msecs</span>
<span class="n">model</span> <span class="o">=</span> <a href="../API/models.html#whobpyt.models.RWWEI2.RWWEI2" title="whobpyt.models.RWWEI2.RWWEI2" class="sphx-glr-backref-module-whobpyt-models-RWWEI2 sphx-glr-backref-type-py-class"><span class="n">RWWEI2</span></a><span class="p">(</span><span class="n">num_regions</span><span class="p">,</span> <span class="n">paramsNode</span><span class="p">,</span> <span class="n">Con_Mtx</span><span class="p">,</span> <span class="n">dist_mtx</span><span class="p">,</span> <span class="n">step_size</span><span class="p">,</span> <span class="n">sim_len</span><span class="p">,</span> <span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>

<span class="n">demoPSD</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">objFun</span> <span class="o">=</span> <a href="../API/optimization.html#whobpyt.optimization.CostsFixedPSD" title="whobpyt.optimization.CostsFixedPSD" class="sphx-glr-backref-module-whobpyt-optimization sphx-glr-backref-type-py-class"><span class="n">CostsFixedPSD</span></a><span class="p">(</span><span class="n">num_regions</span> <span class="o">=</span> <span class="n">num_regions</span><span class="p">,</span> <span class="n">simKey</span> <span class="o">=</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="n">sampleFreqHz</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="n">minFreq</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maxFreq</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="n">targetValue</span> <span class="o">=</span> <span class="n">demoPSD</span><span class="p">,</span> <span class="n">rmTransient</span> <span class="o">=</span> <span class="mi">5000</span><span class="p">,</span> <span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>

<span class="n">empSubject</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">num_epochs</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">num_recordings</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">50</span>

<span class="c1"># Create a Fitting Object</span>
<a href="../API/run.html#whobpyt.run.Fitting_FNGFPG" title="whobpyt.run.Fitting_FNGFPG" class="sphx-glr-backref-module-whobpyt-run sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">F</span></a> <span class="o">=</span> <a href="../API/run.html#whobpyt.run.Fitting_Batch" title="whobpyt.run.Fitting_Batch" class="sphx-glr-backref-module-whobpyt-run sphx-glr-backref-type-py-class"><span class="n">Fitting_Batch</span></a><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">objFun</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
<p>model training</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<a href="../API/run.html#whobpyt.run.Fitting_FNGFPG.train" title="whobpyt.run.Fitting_FNGFPG.train" class="sphx-glr-backref-module-whobpyt-run sphx-glr-backref-type-py-method"><span class="n">F</span><span class="o">.</span><span class="n">train</span></a><span class="p">(</span><span class="n">stim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">empDatas</span> <span class="o">=</span> <span class="p">[</span><span class="n">empSubject</span><span class="p">],</span> <span class="n">num_epochs</span> <span class="o">=</span> <span class="n">num_epochs</span><span class="p">,</span> <span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">learningrate</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">staticIC</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">((</span><span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span><span class="o">/</span><span class="mi">60</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; minutes&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>epoch:  0
Batched Forward Finished
Batched Backwards Finished
epoch:  1
Batched Forward Finished
Batched Backwards Finished
2.9894839763641357 minutes
</pre></div>
</div>
<p>Plots of loss over Training</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><a href="../API/run.html#whobpyt.run.Fitting_FNGFPG" title="whobpyt.run.Fitting_FNGFPG" class="sphx-glr-backref-module-whobpyt-run sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">F</span></a><span class="o">.</span><span class="n">trainingStats</span><span class="o">.</span><span class="n">loss</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <a href="../API/run.html#whobpyt.run.Fitting_FNGFPG" title="whobpyt.run.Fitting_FNGFPG" class="sphx-glr-backref-module-whobpyt-run sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">F</span></a><span class="o">.</span><span class="n">trainingStats</span><span class="o">.</span><span class="n">loss</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Total Loss over Training Epochs&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Total Loss over Training Epochs" class="sphx-glr-single-img" src="../_images/sphx_glr_eg005r__gpu_support_002.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Total Loss over Training Epochs&#39;)
</pre></div>
</div>
</div>
<div class="section" id="training-a-cnmm-model-multimodal-objective-with-fng-fpg-paradigm">
<h2>Training a CNMM Model - Multimodal Objective with FNG-FPG Paradigm<a class="headerlink" href="#training-a-cnmm-model-multimodal-objective-with-fng-fpg-paradigm" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Simulation Length</span>
<span class="n">step_size</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># Step Size in msecs</span>
<span class="n">sim_len</span> <span class="o">=</span> <span class="mi">5000</span> <span class="c1"># Simulation length in msecs</span>
<span class="n">model</span> <span class="o">=</span> <a href="../API/models.html#whobpyt.models.RWWEI2.RWWEI2" title="whobpyt.models.RWWEI2.RWWEI2" class="sphx-glr-backref-module-whobpyt-models-RWWEI2 sphx-glr-backref-type-py-class"><span class="n">RWWEI2_EEG_BOLD</span></a><span class="p">(</span><span class="n">num_regions</span><span class="p">,</span> <span class="n">num_channels</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">paramsEEG</span><span class="p">,</span> <span class="n">paramsBOLD</span><span class="p">,</span> <span class="n">Con_Mtx</span><span class="p">,</span> <span class="n">dist_mtx</span><span class="p">,</span> <span class="n">step_size</span><span class="p">,</span> <span class="n">sim_len</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>

<span class="n">targetValue</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">0.164</span><span class="p">])</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">objFun</span> <span class="o">=</span> <span class="n">CostsmmRWWEI2</span><span class="p">(</span><span class="n">num_regions</span><span class="p">,</span> <span class="n">simKey</span> <span class="o">=</span> <span class="s2">&quot;E&quot;</span><span class="p">,</span> <span class="n">targetValue</span> <span class="o">=</span> <span class="n">targetValue</span><span class="p">,</span> <span class="n">device</span> <span class="o">=</span> <span class="n">device</span><span class="p">)</span>

<span class="c1"># Create a Fitting Object</span>
<a href="../API/run.html#whobpyt.run.Fitting_FNGFPG" title="whobpyt.run.Fitting_FNGFPG" class="sphx-glr-backref-module-whobpyt-run sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">F</span></a> <span class="o">=</span> <a href="../API/run.html#whobpyt.run.Fitting_FNGFPG" title="whobpyt.run.Fitting_FNGFPG" class="sphx-glr-backref-module-whobpyt-run sphx-glr-backref-type-py-class"><span class="n">Fitting_FNGFPG</span></a><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">objFun</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>

<span class="c1"># Training Data</span>
<span class="n">empSubject</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">empSubject</span><span class="p">[</span><span class="s1">&#39;EEG_FC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">channelFC</span>
<span class="n">empSubject</span><span class="p">[</span><span class="s1">&#39;BOLD_FC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sourceFC</span>
<span class="n">num_epochs</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">num_recordings</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">block_len</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># in msec</span>

<span class="c1"># model training</span>
<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<a href="../API/run.html#whobpyt.run.Fitting_FNGFPG.train" title="whobpyt.run.Fitting_FNGFPG.train" class="sphx-glr-backref-module-whobpyt-run sphx-glr-backref-type-py-method"><span class="n">F</span><span class="o">.</span><span class="n">train</span></a><span class="p">(</span><span class="n">stim</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">empDatas</span> <span class="o">=</span> <span class="p">[</span><span class="n">empSubject</span><span class="p">],</span> <span class="n">num_epochs</span> <span class="o">=</span> <span class="n">num_epochs</span><span class="p">,</span> <span class="n">block_len</span> <span class="o">=</span> <span class="n">block_len</span><span class="p">,</span> <span class="n">learningrate</span> <span class="o">=</span> <span class="mf">0.05</span><span class="p">,</span> <span class="n">resetIC</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">((</span><span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span><span class="o">/</span><span class="mi">60</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; minutes&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>epoch:  0
Serial Finished
Blocked Finished
Params Updated
epoch:  1
Serial Finished
Blocked Finished
Params Updated
epoch:  2
Serial Finished
Blocked Finished
Params Updated
1.4422163128852845 minutes
</pre></div>
</div>
<p>Plots of loss over Training</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><a href="../API/run.html#whobpyt.run.Fitting_FNGFPG" title="whobpyt.run.Fitting_FNGFPG" class="sphx-glr-backref-module-whobpyt-run sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">F</span></a><span class="o">.</span><span class="n">trainingStats</span><span class="o">.</span><span class="n">loss</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <a href="../API/run.html#whobpyt.run.Fitting_FNGFPG" title="whobpyt.run.Fitting_FNGFPG" class="sphx-glr-backref-module-whobpyt-run sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">F</span></a><span class="o">.</span><span class="n">trainingStats</span><span class="o">.</span><span class="n">loss</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Total Loss over Training Epochs&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Total Loss over Training Epochs" class="sphx-glr-single-img" src="../_images/sphx_glr_eg005r__gpu_support_003.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Total Loss over Training Epochs&#39;)
</pre></div>
</div>
</div>
<div class="section" id="cnmm-verification-model">
<h2>CNMM Verification Model<a class="headerlink" href="#cnmm-verification-model" title="Permalink to this headline">¶</a></h2>
<p>The Multi-Modal Model</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">eeg</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">LF</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eeg</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">LF</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>

<span class="n">val_sim_len</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="mi">1000</span> <span class="c1"># Simulation length in msecs</span>
<span class="n">model_validate</span> <span class="o">=</span> <span class="n">RWWEI2_EEG_BOLD_np</span><span class="p">(</span><span class="n">num_regions</span><span class="p">,</span> <span class="n">num_channels</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">eeg</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">bold</span><span class="o">.</span><span class="n">params</span><span class="p">,</span> <span class="n">Con_Mtx</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">dist_mtx</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">(),</span> <span class="n">step_size</span><span class="p">,</span> <span class="n">val_sim_len</span><span class="p">)</span>

<span class="n">sim_vals</span><span class="p">,</span> <span class="n">hE</span> <span class="o">=</span> <span class="n">model_validate</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">external</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">hx</span> <span class="o">=</span> <span class="n">model_validate</span><span class="o">.</span><span class="n">createIC</span><span class="p">(</span><span class="n">ver</span> <span class="o">=</span> <span class="mi">0</span><span class="p">),</span> <span class="n">hE</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/work/whobpyt/whobpyt/whobpyt/models/BOLD/BOLD_validate.py:77: RuntimeWarning: overflow encountered in power
  dq = ((f/ro) * (1 - (1 - ro)**(1/f)) - q*v**(1/alpha - 1))/tao
/home/runner/work/whobpyt/whobpyt/whobpyt/models/BOLD/BOLD_validate.py:77: RuntimeWarning: invalid value encountered in subtract
  dq = ((f/ro) * (1 - (1 - ro)**(1/f)) - q*v**(1/alpha - 1))/tao
</pre></div>
</div>
<p>Plots of S_E and S_I Verification</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;S_E and S_I&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_regions</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim_vals</span><span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">10000</span><span class="p">,</span> <span class="n">n</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;S_E Node = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sim_vals</span><span class="p">[</span><span class="s1">&#39;I&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">10000</span><span class="p">,</span> <span class="n">n</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;S_I Node = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time Steps (multiply by step_size to get msec), step_size = &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">step_size</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<img alt="S_E and S_I" class="sphx-glr-single-img" src="../_images/sphx_glr_eg005r__gpu_support_004.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.legend.Legend object at 0x7f4f8786ad90&gt;
</pre></div>
</div>
<p>Plots of EEG PSD Verification</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sampleFreqHz</span> <span class="o">=</span> <span class="mi">1000</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">step_size</span><span class="p">)</span>
<span class="n">sdAxis</span><span class="p">,</span> <span class="n">sdValues</span> <span class="o">=</span> <a href="../API/optimization.html#whobpyt.optimization.CostsPSD.calcPSD" title="whobpyt.optimization.CostsPSD.calcPSD" class="sphx-glr-backref-module-whobpyt-optimization-CostsPSD sphx-glr-backref-type-py-method"><span class="n">CostsPSD</span><span class="o">.</span><span class="n">calcPSD</span></a><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">sim_vals</span><span class="p">[</span><span class="s1">&#39;eeg&#39;</span><span class="p">]),</span> <span class="n">sampleFreqHz</span><span class="p">,</span> <span class="n">minFreq</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">maxFreq</span> <span class="o">=</span> <span class="mi">40</span><span class="p">)</span>
<span class="n">sdAxis_dS</span><span class="p">,</span> <span class="n">sdValues_dS</span> <span class="o">=</span> <a href="../API/optimization.html#whobpyt.optimization.CostsPSD.downSmoothPSD" title="whobpyt.optimization.CostsPSD.downSmoothPSD" class="sphx-glr-backref-module-whobpyt-optimization-CostsPSD sphx-glr-backref-type-py-method"><span class="n">CostsPSD</span><span class="o">.</span><span class="n">downSmoothPSD</span></a><span class="p">(</span><span class="n">sdAxis</span><span class="p">,</span> <span class="n">sdValues</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="n">sdAxis_dS</span><span class="p">,</span> <span class="n">sdValues_dS_scaled</span> <span class="o">=</span> <a href="../API/optimization.html#whobpyt.optimization.CostsPSD.scalePSD" title="whobpyt.optimization.CostsPSD.scalePSD" class="sphx-glr-backref-module-whobpyt-optimization-CostsPSD sphx-glr-backref-type-py-method"><span class="n">CostsPSD</span><span class="o">.</span><span class="n">scalePSD</span></a><span class="p">(</span><span class="n">sdAxis_dS</span><span class="p">,</span> <span class="n">sdValues_dS</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_channels</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sdAxis_dS</span><span class="p">,</span> <span class="n">sdValues_dS_scaled</span><span class="o">.</span><span class="n">detach</span><span class="p">()[:,</span><span class="n">n</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Hz&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;PSD&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Simulated EEG PSD: After Training&quot;</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Simulated EEG PSD: After Training" class="sphx-glr-single-img" src="../_images/sphx_glr_eg005r__gpu_support_005.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Text(0.5, 1.0, &#39;Simulated EEG PSD: After Training&#39;)
</pre></div>
</div>
<p>Plots of BOLD FC Verification</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">skip_trans</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">500</span><span class="o">/</span><span class="n">step_size</span><span class="p">)</span>
<span class="n">sim_FC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">corrcoef</span><span class="p">((</span><span class="n">sim_vals</span><span class="p">[</span><span class="s1">&#39;bold&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)[:,</span><span class="n">skip_trans</span><span class="p">:])</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Simulated BOLD FC: After Training&quot;</span><span class="p">)</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">num_regions</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">sim_FC</span><span class="p">,</span> <span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;RdBu_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=-</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">)</span>
</pre></div>
</div>
<img alt="Simulated BOLD FC: After Training" class="sphx-glr-single-img" src="../_images/sphx_glr_eg005r__gpu_support_006.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;Axes: title={&#39;center&#39;: &#39;Simulated BOLD FC: After Training&#39;}&gt;
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 4 minutes  47.850 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-eg005r-gpu-support-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/fa5f33c0c878698fbdb9bd04263fd465/eg005r__gpu_support.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">eg005r__gpu_support.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/c039060c6253f8db553e07172417dfd9/eg005r__gpu_support.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">eg005r__gpu_support.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="eg004r__fitting_JR_example.html" class="btn btn-neutral float-left" title="Fitting JR model (Tepit data)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright KCNI Griffiths Lab &amp; Contributors

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>